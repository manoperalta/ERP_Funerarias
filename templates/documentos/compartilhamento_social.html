{% load meta_tags %}

<!-- Botões de Compartilhamento Social -->
<div class="social-sharing mt-4">
    <h5 class="mb-3">
        <i class="bi bi-share"></i> Compartilhar
    </h5>
    
    <div class="row g-2">
        <!-- WhatsApp -->
        <div class="col-6 col-md-3">
            <a href="{% whatsapp_share_url documento %}" 
               target="_blank" 
               class="btn btn-success w-100 btn-sm">
                <i class="bi bi-whatsapp"></i> WhatsApp
            </a>
        </div>
        
        <!-- Facebook -->
        <div class="col-6 col-md-3">
            <a href="{% facebook_share_url documento %}" 
               target="_blank" 
               class="btn btn-primary w-100 btn-sm">
                <i class="bi bi-facebook"></i> Facebook
            </a>
        </div>
        
        <!-- Twitter -->
        <div class="col-6 col-md-3">
            <a href="{% twitter_share_url documento %}" 
               target="_blank" 
               class="btn btn-info w-100 btn-sm">
                <i class="bi bi-twitter"></i> Twitter
            </a>
        </div>
        
        <!-- Copiar Link -->
        <div class="col-6 col-md-3">
            <button onclick="copyToClipboard('{{ request.build_absolute_uri }}')" 
                    class="btn btn-secondary w-100 btn-sm">
                <i class="bi bi-link-45deg"></i> Copiar Link
            </button>
        </div>
    </div>
    
    <!-- QR Code -->
    <div class="mt-3 text-center">
        <button class="btn btn-outline-dark btn-sm" 
                type="button" 
                data-bs-toggle="collapse" 
                data-bs-target="#qrCode" 
                aria-expanded="false">
            <i class="bi bi-qr-code"></i> QR Code
        </button>
        
        <div class="collapse mt-2" id="qrCode">
            <div class="card card-body text-center">
                <img src="{% generate_qr_code request.build_absolute_uri 150 %}" 
                     alt="QR Code" 
                     class="mx-auto" 
                     style="max-width: 150px;">
                <small class="text-muted mt-2">
                    Escaneie para acessar no celular
                </small>
            </div>
        </div>
    </div>
</div>

<!-- JavaScript para copiar link -->
<script>
function copyToClipboard(text) {
    navigator.clipboard.writeText(text).then(function() {
        // Mostra toast de sucesso
        showToast('Link copiado para a área de transferência!', 'success');
    }, function(err) {
        console.error('Erro ao copiar: ', err);
        showToast('Erro ao copiar link', 'error');
    });
}

function showToast(message, type) {
    // Cria toast dinâmico
    const toastHtml = `
        <div class="toast align-items-center text-white bg-${type === 'success' ? 'success' : 'danger'} border-0" role="alert">
            <div class="d-flex">
                <div class="toast-body">
                    ${message}
                </div>
                <button type="button" class="btn-close btn-close-white me-2 m-auto" data-bs-dismiss="toast"></button>
            </div>
        </div>
    `;
    
    // Adiciona ao container de toasts
    let toastContainer = document.getElementById('toast-container');
    if (!toastContainer) {
        toastContainer = document.createElement('div');
        toastContainer.id = 'toast-container';
        toastContainer.className = 'toast-container position-fixed bottom-0 end-0 p-3';
        document.body.appendChild(toastContainer);
    }
    
    toastContainer.insertAdjacentHTML('beforeend', toastHtml);
    
    // Inicializa e mostra o toast
    const toastElement = toastContainer.lastElementChild;
    const toast = new bootstrap.Toast(toastElement);
    toast.show();
    
    // Remove o elemento após ser ocultado
    toastElement.addEventListener('hidden.bs.toast', () => {
        toastElement.remove();
    });
}
</script>

<style>
.social-sharing .btn {
    font-size: 0.875rem;
    padding: 0.5rem;
}

.social-sharing .btn i {
    margin-right: 0.25rem;
}

@media (max-width: 576px) {
    .social-sharing .btn {
        font-size: 0.75rem;
        padding: 0.375rem 0.25rem;
    }
    
    .social-sharing .btn i {
        margin-right: 0.125rem;
    }
}
</style>

